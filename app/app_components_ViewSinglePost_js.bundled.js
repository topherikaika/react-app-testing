"use strict";
/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(self["webpackChunkcomplex_react_app"] = self["webpackChunkcomplex_react_app"] || []).push([["app_components_ViewSinglePost_js"],{

/***/ "./app/components/ViewSinglePost.js":
/*!******************************************!*\
  !*** ./app/components/ViewSinglePost.js ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _Page__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Page */ \"./app/components/Page.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router/dist/index.js\");\n/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! react-router-dom */ \"./node_modules/react-router-dom/dist/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(axios__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _LoadingDotsIcon__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./LoadingDotsIcon */ \"./app/components/LoadingDotsIcon.js\");\n/* harmony import */ var react_markdown__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! react-markdown */ \"./node_modules/react-markdown/src/react-markdown.js\");\n/* harmony import */ var react_markdown__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(react_markdown__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var react_tooltip__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! react-tooltip */ \"./node_modules/react-tooltip/dist/index.es.js\");\n/* harmony import */ var _NotFound__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./NotFound */ \"./app/components/NotFound.js\");\n/* harmony import */ var _StateContext__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../StateContext */ \"./app/StateContext.js\");\n/* harmony import */ var _DispatchContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../DispatchContext */ \"./app/DispatchContext.js\");\n\n\n\n\n\n\n\n\n\n\nfunction ViewSinglePost() {\n  const navigate = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_9__.useNavigate)();\n  const appState = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_StateContext__WEBPACK_IMPORTED_MODULE_7__[\"default\"]);\n  const appDispatch = (0,react__WEBPACK_IMPORTED_MODULE_0__.useContext)(_DispatchContext__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\n  const [isLoading, setIsLoading] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)(true);\n  const [post, setPost] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)();\n  const {\n    id\n  } = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_9__.useParams)();\n  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {\n    const ourRequest = axios__WEBPACK_IMPORTED_MODULE_2___default().CancelToken.source();\n    async function fetchPost() {\n      try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_2___default().get(`/post/${id}`, {\n          cancelToken: ourRequest.token\n        });\n        setPost(response.data);\n        setIsLoading(false);\n      } catch (e) {\n        console.log(\"There was a problem or the request was cancelled\");\n      }\n    }\n    fetchPost();\n    return () => {\n      ourRequest.cancel();\n    };\n  }, [id]);\n  if (!isLoading && !post) {\n    return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_NotFound__WEBPACK_IMPORTED_MODULE_6__[\"default\"], null);\n  }\n  if (isLoading) return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_Page__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n    title: \"...\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_LoadingDotsIcon__WEBPACK_IMPORTED_MODULE_3__[\"default\"], null));\n  const date = new Date(post.createdDate);\n  const dateFormatted = `${date.getMonth() + 1}/${date.getDay()}/${date.getFullYear()}`;\n  function isOwner() {\n    if (appState.loggedIn) {\n      return appState.user.username == post.author.username;\n    }\n    return false;\n  }\n  async function deleteHandler() {\n    const areYouSure = window.confirm(\"Do you really want to delete this post?\");\n    if (areYouSure) {\n      try {\n        const response = await axios__WEBPACK_IMPORTED_MODULE_2___default()[\"delete\"](`/post/${id}`, {\n          data: {\n            token: appState.user.token\n          }\n        });\n        if (response.data == \"Success\") {\n          //display flash message\n          appDispatch({\n            type: \"flashMessage\",\n            value: \"Post was successfully deleted\"\n          });\n          //redirect to the user profile\n          navigate(`/profile/${appState.user.username}`);\n        }\n      } catch (e) {\n        console.log(\"There was a problem\");\n      }\n    }\n  }\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(_Page__WEBPACK_IMPORTED_MODULE_1__[\"default\"], {\n    title: post.title\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"d-flex justify-content-between\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"h2\", null, post.title), isOwner() && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"span\", {\n    className: \"pt-2\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_10__.Link, {\n    to: `/post/${post._id}/edit`,\n    \"data-tip\": \"Edit\",\n    \"data-for\": \"edit\",\n    className: \"text-primary mr-2\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"i\", {\n    className: \"fas fa-edit\"\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_tooltip__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n    id: \"edit\",\n    className: \"custom-tooltip\"\n  }), \" \", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"a\", {\n    onClick: deleteHandler,\n    \"data-tip\": \"Delete\",\n    \"data-for\": \"delete\",\n    className: \"delete-post-button text-danger\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"i\", {\n    className: \"fas fa-trash\"\n  })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_tooltip__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n    id: \"delete\",\n    className: \"custom-tooltip\"\n  }))), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"p\", {\n    className: \"text-muted small mb-4\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_10__.Link, {\n    to: `/profile/${post.author.username}`\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"img\", {\n    className: \"avatar-tiny\",\n    src: post.author.avatar\n  })), \"Posted by \", /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_10__.Link, {\n    to: `/profile/${post.author.username}`\n  }, post.author.username), \" on \", dateFormatted), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement(\"div\", {\n    className: \"body-content\"\n  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0___default().createElement((react_markdown__WEBPACK_IMPORTED_MODULE_4___default()), {\n    children: post.body,\n    allowedElements: [\"p\", \"br\", \"em\", \"h1\", \"h2\", \"h3\", \"h4\", \"h5\", \"h6\", \"ul\", \"ol\", \"li\"]\n  })));\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ViewSinglePost);\n\n//# sourceURL=webpack://complex-react-app/./app/components/ViewSinglePost.js?");

/***/ })

}]);